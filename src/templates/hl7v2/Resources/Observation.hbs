{
    "fullUrl":"urn:uuid:{{ID}}",
    "resource":{
        "resourceType": "Observation",
        "id":"{{ID}}",
        "code":
        {
            {{>DataType/CWECodeableConcept.hbs CWE=OBX-3}},
        },
        "valueQuantity":
        {
            {{#if (eq OBX-2 "NM")}},
                {{#each (getFieldRepeats OBX-5)}}
                    "value":"{{this}}",
                {{/each}}
            {{/if}},
            {{#if (eq OBX-2 "SN")}},
                {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
            {{/if}},
            {{#if (eq OBX-2 "NA" "NM")}},
                {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
            {{/if}},
        },
        {{#if (eq OBX-2 "ST" "FT" "TX")}},
            {{#each (getFieldRepeats OBX-5)}}
                "valueString":"{{this}}",
            {{/each}}
        {{/if}},
        "valueCodeableConcept":
        {
            {{#if (eq OBX-2 "CF" "CNE" "CWE" "CE")}},
                {{#each (getFieldRepeats OBX-5)}}
                    {{>DataType/CWECodeableConcept.hbs CWE=this}},
                {{/each}}
            {{/if}},
        },
        "valuePeriod":
        {
            {{#if (eq OBX-2 "DR")}},
                {{#each (getFieldRepeats OBX-5)}}
                    {{>DataType/DR.hbs DR=this}},
                {{/each}}
            {{/if}},
        },
        {{#if (eq OBX-2 "DTM" "DT")}},
            {{#each (getFieldRepeats OBX-5)}}
                "valueDateTime":"{{formatAsDateTime this}}",
            {{/each}}
        {{/if}},
        {{#if (eq OBX-2 "TM")}},
            {{#each (getFieldRepeats OBX-5)}}
                "valueTime":"{{this}}",
            {{/each}}
        {{/if}},
        "valueRatio":
        {
            {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 ":" "/"))}},
                {{#each (getFieldRepeats OBX-5)}}
                    {{>DataType/SNRatio.hbs SN=this}},
                {{/each}}
            {{/if}},
            "numerator":
            {
                {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 ":" "/"))}},
                    {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                {{/if}},
            },
            "denominator":
            {
                {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 ":" "/"))}},
                    {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                {{/if}},
            },
        },
        "valueRange":
        {
            {{#if (eq OBX-2 "SN")}},
                {{#each (getFieldRepeats OBX-5)}}
                    {{>DataType/SNRange.hbs SN=this}},
                {{/each}}
            {{/if}},
            "low":
            {
                {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 "-"))}},
                    {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                {{/if}},
            },
            "high":
            {
                {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 "-"))}},
                    {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                {{/if}},
            },
        },
        "interpretation":
        [
            {{#each (getFieldRepeats OBX-8)}}
                { {{>DataType/CWECodeableConcept.hbs mapping="CodeSystem/InterpretationCode.hbs" CWE=this}} },
            {{/each}}
        ],
        "status":{{>DataType/_string.hbs mapping="CodeSystem/ObservationStatus.hbs" inCode=OBX-11 }},
        "effectiveDateTime":"{{formatAsDateTime OBX-14}}",
        "method":
        {
            {{#each (getFieldRepeats OBX-17)}}
            {{/each}}
        },
        "bodySite":
        {
            {{#each (getFieldRepeats OBX-20)}}
                {{>DataType/CWECodeableConcept.hbs CWE=this}},
            {{/each}}
        },
        "identifier":
        [
            { {{>DataType/EIIdentifier.hbs EI=OBX-21}} },
            {
                "type":
                {
                    "coding":
                    [
                        {
                            {{#if OBX-21}},
                                "code":"FILL",
                            {{/if}},
                        },
                    ],
                },
            },
        ],
        "component":
        [
            {
                "code":
                {
                    {{>DataType/CWECodeableConcept.hbs CWE=OBX-3}},
                },
                "valueQuantity":
                {
                    {{#if (eq OBX-2 "NM")}},
                        {{#each (getFieldRepeats OBX-5)}}
                            "value":"{{this}}",
                        {{/each}}
                    {{/if}},
                    {{#if (eq OBX-2 "SN")}},
                        {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                    {{/if}},
                    {{#if (eq OBX-2 "NA" "NM")}},
                        {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                    {{/if}},
                },
                {{#if (eq OBX-2 "ST" "FT" "TX")}},
                    {{#each (getFieldRepeats OBX-5)}}
                        "valueString":"{{this}}",
                    {{/each}}
                {{/if}},
                "valuePeriod":
                {
                    {{#if (eq OBX-2 "DR")}},
                        {{#each (getFieldRepeats OBX-5)}}
                            {{>DataType/DR.hbs DR=this}},
                        {{/each}}
                    {{/if}},
                },
                {{#if (eq OBX-2 "DTM" "DT")}},
                    {{#each (getFieldRepeats OBX-5)}}
                        "valueDateTime":"{{formatAsDateTime this}}",
                    {{/each}}
                {{/if}},
                {{#if (eq OBX-2 "TM")}},
                    {{#each (getFieldRepeats OBX-5)}}
                        "valueTime":"{{this}}",
                    {{/each}}
                {{/if}},
                "valueRatio":
                {
                    {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 ":" "/"))}},
                        {{#each (getFieldRepeats OBX-5)}}
                            {{>DataType/SNRatio.hbs SN=this}},
                        {{/each}}
                    {{/if}},
                    "numerator":
                    {
                        {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 ":" "/"))}},
                            {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                        {{/if}},
                    },
                    "denominator":
                    {
                        {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 ":" "/"))}},
                            {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                        {{/if}},
                    },
                },
                "valueRange":
                {
                    {{#if (eq OBX-2 "SN")}},
                        {{#each (getFieldRepeats OBX-5)}}
                            {{>DataType/SNRange.hbs SN=this}},
                        {{/each}}
                    {{/if}},
                    "low":
                    {
                        {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 "-"))}},
                            {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                        {{/if}},
                    },
                    "high":
                    {
                        {{#if (and (eq OBX-2 "SN") (eq OBX-5-3 "-"))}},
                            {{>DataType/CWEQuantity.hbs CWE=OBX-6}},
                        {{/if}},
                    },
                },
                "referenceRange":
                [
                    {
                        "text":"{{OBX-7}}",
                    },
                ],
                "interpretation":
                [
                    {{#each (getFieldRepeats OBX-8)}}
                        { {{>DataType/CWECodeableConcept.hbs mapping="CodeSystem/InterpretationCode.hbs" CWE=this}} },
                    {{/each}}
                ],
            },
        ],
    },
    "request":{
        "method":"PUT",
        "url":"Observation/{{ID}}",
    },
},
